<form>
  <div class="field">
    <label class="label">Category</label>
    <select name="category">
      <option selected disabled>Please choose</option>
      <% categories.forEach(category => { %>
        <option<% if(category === selectedCategory) {%> selected <%} %>><%= category %></option>
      <% }) %>
    </select>
    <button class="button">filter</button>
  </div>
</form>


<h2 class="subtitle">Category: <%= blog.category.name %></h2>



<ul class="comments">
  <h2 class="subtitle">Comments</h2>
  <% blog.comments.forEach(comment => { %>
    <li>
      <% if(comment.isModerated || locals.currentUser.isAdmin || comment.isOwnedBy(locals.currentUser)) { %>
        <div class="box">
          <% if(comment.isOwnedBy(locals.currentUser) || locals.currentUser.isAdmin) { %>
            <form class="delete" method="POST" action="/blogs/<%= blog._id %>/comments/<%= comment._id %>">
              <input type="hidden" name="_method" value="DELETE">
              <button class="btn">Delete</button>
            </form>
          <% } %>
          <% if(locals.currentUser.isAdmin && !comment.isModerated){ %>
            <form class="delete" method="POST" action="/blogs/<%= blog._id %>/comments/<%= comment._id %>/moderate">
              <input type="hidden" name="_method" value="PATCH">
              <button class="btn">Moderate</button>
            </form>
          <% } %>

          <% if(comment.isModerated || locals.currentUser.isAdmin ||comment.isOwnedBy(locals.currentUser)){ %>
            <article class="media">
              <div class="media-content">
                <div class="content">
                  <p>
                    <%= comment.content %>
                  </p>
                  <% if(comment.user) { %>
                    <strong><%= comment.user.username %></strong>
                  <% } %>
                </div>
              </div>
            </article>
          <% } %>
        </div>
      <% } %>
    </li>
  <% }) %>
</ul>





<ul class="comments">
  <h2 class="subtitle">Comments</h2>
  <% blog.comments.forEach(comment => { %>
    <li>
      <% if(comment.isModerated || locals.currentUser.isAdmin || comment.isOwnedBy(locals.currentUser)) { %>
        <div class="box">
          <% if(comment.isOwnedBy(locals.currentUser) || locals.currentUser.isAdmin) { %>
            <form method="POST" action="/blogs/<%= blog._id %>/comments/<%= comment._id %>">
              <input type="hidden" name="_method" value="DELETE">
              <button class="btn">Delete</button>
            </form
          <% } %>
          <% if(locals.currentUser.isAdmin && !comment.isModerated){ %>
            <form method="POST" action="/blogs/<%= blog._id %>/comments/<%= comment._id %>/moderate">
              <input type="hidden" name="_method" value="PATCH">
              <button class="btn">Moderate</button>
            </form>
          <% } %>

          <% if(comment.isModerated || locals.currentUser.isAdmin ||comment.isOwnedBy(locals.currentUser)){ %>
            <article class="media">
              <div class="media-content">
                <div class="content">
                  <p>
                    <%= comment.content %>
                  </p>
                  <% if(comment.user) { %>
                    <strong><%= comment.user.username %></strong>
                  <% } %>
                </div>
              </div>
            </article>
          <% } %>
        </div>
      <% } %>
    </li>
  <% }) %>
</ul>
